//projects = ["forum", "leilao"]

properties(
    [
        parameters([
                text(name: 'PROJECT', defaultValue: 'primeiro\nsegundo\nterceiro', description: 'Passe uma lista de projetos, um em cada linha'),
        ])   
    ]
)  

node {
    cleanWs()

    stage ('call security pipeline') {
        def projects = params.PROJECT
        projects.tokenize('\n').each { project ->
            try{
                build job: 'security-pipeline', parameters: [$class: 'StringParameterValue', name: 'PROJECT', value: project], wait: false
            }catch(Exception e) {
                echo e
            }
            sleep(time:20,unit:"SECONDS")
        }
    }
}
